pkgname=sliver
pkgver=1.6.8
pkgrel=1
pkgdesc="Sliver is a an opensource C2 framework designed by bishop fox"
url="https://github.com/BishopFox/sliver"
arch=('aarch64')
optdepends=()
license=('BSD-3-Clause')
provides=("${pkgname}")
install=
source=(
    "https://github.com/BishopFox/sliver/releases/download/v${pkgver}/sliver-client_linux-arm64"
    "https://github.com/BishopFox/sliver/releases/download/v${pkgver}/sliver-server_linux-arm64"
)
sha512sums=('1a7d8bf2bd8776ce9c9e0b9147ea0421b1b135f9942beb2c53a238d648f484a2a9ad4d154b7c98fbcb19b401e93dcbfe9f3f2adf6f425900b7aa7320295b05f1'
            'b54299a962b96efd2da03dd6c27fe56d283b355c38c3af6a84f58819c7a7f14a6b637dfc66447df32c8a8202119a5ac57b4967cdf4488e1db3680a14bc766b79')

prepare() {
    chmod +x ./sliver-client_linux-arm64
    chmod +x ./sliver-server_linux-arm64

    ./sliver-client_linux-arm64 completion zsh > _sliver-client
    ./sliver-server_linux-arm64 completion zsh > _sliver-server
}

package() {
    mkdir -p $pkgdir/usr/bin
    mkdir -p $pkgdir/usr/share/zsh/site-functions

    install -Dm 755 sliver-client_linux-arm64 $pkgdir/usr/bin/sliver-client
    install -Dm 755 sliver-server_linux-arm64 $pkgdir/usr/bin/sliver-server

    install -Dm 644 _sliver-client $pkgdir/usr/share/zsh/site-functions/_sliver-client
    install -Dm 644 _sliver-server $pkgdir/usr/share/zsh/site-functions/_sliver-server
}
